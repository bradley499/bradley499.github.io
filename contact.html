<!DOCTYPE html>
<html>
	<head>
		<title>Contact ~ Bradley Marshall</title>
		<meta name="description" content="Contact Bradley Marshall for further information">
		<meta name="viewport" content="width=device-width, user-scalable=no">
		<link rel="stylesheet" type="text/css" href="assets/style.css">
		<script async src="https://www.googletagmanager.com/gtag/js?id=UA-157001746-1"></script>
		<script>
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());
			gtag('config', 'UA-157001746-1');
		</script>
		<script type="text/javascript">
			document.addEventListener("DOMContentLoaded",function() {
				document.getElementById("formContact").addEventListener("submit",function(e) {
					e.preventDefault();
					const inputs = [document.getElementById("contactName"), document.getElementById("contactEmail"), document.getElementById("contactMessage"), document.getElementById("contactSubmit")];
					const contact = {
						"name": inputs[0].value,
						"email": inputs[1].value,
						"message": inputs[2].value
					};

					inputs.forEach(element => {
						element.setAttribute("disabled", "disabled");
						element.style.cursor = "wait";
					});
					var request = new XMLHttpRequest();
					request.open("POST", "https://script.google.com/macros/s/AKfycbyQe2cw1IUaXtptR3wk6DfAAiJFbb1aUALghRH07SnQXIwxoRjiZGWGnSfo1pMeDr4jig/exec", true);
					request.setRequestHeader('Content-Type', 'text/plain');
					request.onreadystatechange = function() {
						if (this.status >= 400) {
							return false;
						} else if (this.readyState === 4){
							if (request.status === 200) {
								const response = JSON.parse(this.responseText);
								document.body.style.cursor = "";
								inputs.forEach(element => {
									element.removeAttribute("disabled");
									element.style.cursor = "";
								});
								if (response["status"] == "success"){
									document.getElementById("formContact").outerHTML = "<center><h3>You message request has been sent!</h3><p>Bradley should hopefully be in contact with you soon...</p></center>";
								} else {
									const error = document.getElementById("contactError");
									try {
										error.innerText = "Failed to send: Unable to send your message due to the following reason:\n" + response["response"];
									} catch (e) {
										error.innerText = "Failed to send: An unexpected error has prevented your message from being sent. We apologise for the inconvenience.";
									}
									error.style.display = "block";
								}
							}
						}
					};
					request.send(JSON.stringify(contact));
				});
			});			
		</script>
	</head>
	<body>
		<div class="banner">
			<a href="/"><div class="bannerImg"></div></a>
			<h1 id="name">Bradley Marshall</h1>
			<p class="about">Where design and simplicity meets functionality...</p>
		</div>
		<div class="content">
			<div class="main">
				<div class="mainContent">
					<form id="formContact">
						<div id="contactError">Sorry, but Javascript is required to get in contact.<noscript><style type="text/css">div#contactError{display:block!important}table.formTableAlignment{display:none!important}</style></noscript></div>
						<table class="formTableAlignment">
							<tr>
								<td>
									<div>
										<table class="displayTableInline"><tr><td class="itemHold">Name:</td><td><input type="text" id="contactName" class="inputArea" placeholder="John Doe" required="required"></td></tr></table>
										<table class="displayTableInline"><tr><td class="itemHold itemHoldLarge">Email<span class="addressDisplayBuffer"> address</span>:</td><td><input type="email" id="contactEmail" class="inputArea" placeholder="john@doe.com" required="required"></td></tr></table>
									</div>
								</td>
							</tr>
							<tr>
								<td>
									<textarea id="contactMessage" placeholder=" Message..." class="inputArea" required="required"></textarea>
								</td>
							</tr>
							<tr>
								<td>
									<input type="submit" value="Submit" class="submitButton" id="contactSubmit">
								</td>
							</tr>
						</table>
					</form>
				</div>
			</div>
			<div class="panel">
				<div>
					<ul class="navigation">
						<li>
							<a href="/" title="Home">Home</a>
						</li>
						<li>
							<a href="/contact" title="Contact">Contact</a>
						</li>
						<li>
							<a href="/updates" title="Blog">Blog</a>
						</li>
						<li>
							<a href="https://github.com/bradley499/" title="Github @bradley499">GitHub</a>
						</li>
					</ul>
					<hr>
				</div>
				<em>&copy; Bradley Marshall</em>
			</div>
		</div>
		<div id="privacy">
			<p>This page uses <a href="/policies#cookies" class="boldLink" title="Read the Cookie Policy">Cookies</a> for analytical perposes.</p>
		</div>
	</body>
</html>